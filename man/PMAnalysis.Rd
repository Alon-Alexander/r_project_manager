% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analysis.R
\name{PMAnalysis}
\alias{PMAnalysis}
\title{Analysis class to manage an analysis folder}
\description{
This object can be used to manage an analysis folder within a project.
Each analysis contains code, outputs, intermediate results, and logs.
}
\examples{
# Create a project and analysis
folder <- withr::local_tempdir()
pm <- pm_create_project(folder)

# Create a new analysis
analysis <- pm$create_analysis("data_preparation")
analysis

# Load an existing analysis from project
analysis <- pm$get_analysis("data_preparation")

# Load an existing analysis from path
analysis <- PMAnalysis$new(path = file.path(folder, "analyses", "data_preparation"))


## ------------------------------------------------
## Method `PMAnalysis$get_artifact`
## ------------------------------------------------

folder <- withr::local_tempdir()
pm <- pm_create_project(folder)
analysis1 <- pm$create_analysis("data_preparation")
analysis2 <- pm$create_analysis("modeling")

# Create a test output file in analysis1
output <- analysis1$get_output_path("results.csv", type = "table")
write.csv(data.frame(x = 1:5), output$path)

# Get artifact from analysis2 (which gets it from analysis1)
artifact <- analysis2$get_artifact("results", analysis_name = "data_preparation")

# Get artifact from current analysis (default behavior)
artifact <- analysis1$get_artifact("results")

# Get artifact without specifying analysis (if unique across all analyses)
artifact <- analysis2$get_artifact("results", analysis_name = NULL)

## ------------------------------------------------
## Method `PMAnalysis$get_intermediate_artifact`
## ------------------------------------------------

folder <- withr::local_tempdir()
pm <- pm_create_project(folder)
analysis <- pm$create_analysis("data_preparation")

# Get artifact from current analysis's intermediate folder
# If file exists, returns it; otherwise returns path for new file
artifact <- analysis$get_intermediate_artifact("temp_data")
if (artifact$exists()) {
  data <- artifact$read()
} else {
  # File doesn't exist yet, can write to it
  artifact$write(data.frame(x = 1:5))
}

## ------------------------------------------------
## Method `PMAnalysis$list_outputs`
## ------------------------------------------------

folder <- withr::local_tempdir()
pm <- pm_create_project(folder)
analysis <- pm$create_analysis("my_analysis")

# Create some output files
output1 <- analysis$get_output_path("results.csv", type = "table")
output2 <- analysis$get_output_path("plot.png", type = "figure")

# List all outputs
outputs <- analysis$list_outputs()
length(outputs)  # Number of output files

# List intermediate files
intermediates <- analysis$list_outputs(intermediate = TRUE)

## ------------------------------------------------
## Method `PMAnalysis$get_output_path`
## ------------------------------------------------

folder <- withr::local_tempdir()
pm <- pm_create_project(folder)
analysis <- pm$create_analysis("my_analysis")

# Get output path for a CSV file
output <- analysis$get_output_path("results.csv", type = "table")
output$id    # "results"
output$path  # full path to results.csv in outputs/

# Get intermediate path without extension (will add .parquet for table type)
intermediate <- analysis$get_output_path("temp_data", type = "table", intermediate = TRUE)
intermediate$id    # "temp_data"
intermediate$path  # full path to temp_data.parquet in intermediate/
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{path}}{Full path to the analysis's folder}

\item{\code{name}}{Name of the analysis (folder name within analyses/)}

\item{\code{project_path}}{Full path to the project's folder (if created from project)}
}
\if{html}{\out{</div>}}
}
\section{Active bindings}{
\if{html}{\out{<div class="r6-active-bindings">}}
\describe{
\item{\code{project}}{(\code{PMProject})\cr
Get the project containing this analysis}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-PMAnalysis-new}{\code{PMAnalysis$new()}}
\item \href{#method-PMAnalysis-validate}{\code{PMAnalysis$validate()}}
\item \href{#method-PMAnalysis-print}{\code{PMAnalysis$print()}}
\item \href{#method-PMAnalysis-get_artifact}{\code{PMAnalysis$get_artifact()}}
\item \href{#method-PMAnalysis-get_intermediate_artifact}{\code{PMAnalysis$get_intermediate_artifact()}}
\item \href{#method-PMAnalysis-list_outputs}{\code{PMAnalysis$list_outputs()}}
\item \href{#method-PMAnalysis-get_output_path}{\code{PMAnalysis$get_output_path()}}
\item \href{#method-PMAnalysis-clone}{\code{PMAnalysis$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PMAnalysis-new"></a>}}
\if{latex}{\out{\hypertarget{method-PMAnalysis-new}{}}}
\subsection{Method \code{new()}}{
Create a PMAnalysis object
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PMAnalysis$new(project = NULL, name = NULL, path = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{project}}{PMProject object. If provided, creates analysis within that project.}

\item{\code{name}}{Character. Name of the analysis (folder name). Required if project is provided.}

\item{\code{path}}{Character. Full path to the analysis folder. Required if project is not provided.}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PMAnalysis-validate"></a>}}
\if{latex}{\out{\hypertarget{method-PMAnalysis-validate}{}}}
\subsection{Method \code{validate()}}{
Validate the analysis folder.
Makes sure all expected files and folders exist.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PMAnalysis$validate()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PMAnalysis-print"></a>}}
\if{latex}{\out{\hypertarget{method-PMAnalysis-print}{}}}
\subsection{Method \code{print()}}{
Print method for PMAnalysis
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PMAnalysis$print()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PMAnalysis-get_artifact"></a>}}
\if{latex}{\out{\hypertarget{method-PMAnalysis-get_artifact}{}}}
\subsection{Method \code{get_artifact()}}{
Get an artifact (output file) from another analysis by ID.
Searches for files with the given ID (filename without extension) in analysis output directories.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PMAnalysis$get_artifact(id, analysis_name = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{id}}{Character. The artifact ID (filename without extension).}

\item{\code{analysis_name}}{Character. Optional name of the analysis to search in.
If not provided, uses the current analysis's name. If explicitly set to \code{NULL},
searches all analyses and fails if not exactly one match is found.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A \code{PMData} object with the artifact's ID and path.
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{folder <- withr::local_tempdir()
pm <- pm_create_project(folder)
analysis1 <- pm$create_analysis("data_preparation")
analysis2 <- pm$create_analysis("modeling")

# Create a test output file in analysis1
output <- analysis1$get_output_path("results.csv", type = "table")
write.csv(data.frame(x = 1:5), output$path)

# Get artifact from analysis2 (which gets it from analysis1)
artifact <- analysis2$get_artifact("results", analysis_name = "data_preparation")

# Get artifact from current analysis (default behavior)
artifact <- analysis1$get_artifact("results")

# Get artifact without specifying analysis (if unique across all analyses)
artifact <- analysis2$get_artifact("results", analysis_name = NULL)
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PMAnalysis-get_intermediate_artifact"></a>}}
\if{latex}{\out{\hypertarget{method-PMAnalysis-get_intermediate_artifact}{}}}
\subsection{Method \code{get_intermediate_artifact()}}{
Get an intermediate artifact from the current analysis's intermediate folder.
Searches for existing files with the given ID (filename without extension) in the intermediate directory.
If an existing file is found, returns it. If no existing file is found, returns the path
via \code{get_output_path()} (the file may not exist yet).
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PMAnalysis$get_intermediate_artifact(id)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{id}}{Character. The artifact ID (filename without extension).}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A \code{PMData} object with the artifact's ID and path.
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{folder <- withr::local_tempdir()
pm <- pm_create_project(folder)
analysis <- pm$create_analysis("data_preparation")

# Get artifact from current analysis's intermediate folder
# If file exists, returns it; otherwise returns path for new file
artifact <- analysis$get_intermediate_artifact("temp_data")
if (artifact$exists()) {
  data <- artifact$read()
} else {
  # File doesn't exist yet, can write to it
  artifact$write(data.frame(x = 1:5))
}
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PMAnalysis-list_outputs"></a>}}
\if{latex}{\out{\hypertarget{method-PMAnalysis-list_outputs}{}}}
\subsection{Method \code{list_outputs()}}{
List all output files in the analysis.
Returns a list of PMData objects for all files in the outputs or intermediate directory.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PMAnalysis$list_outputs(intermediate = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{intermediate}}{Logical. If TRUE, lists files in intermediate/ folder; if FALSE, in outputs/ folder.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A list of \code{PMData} objects, one for each file found.
Each object has:
\itemize{
\item \code{id}: The file name without extension
\item \code{path}: The full absolute path to the file
}
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{folder <- withr::local_tempdir()
pm <- pm_create_project(folder)
analysis <- pm$create_analysis("my_analysis")

# Create some output files
output1 <- analysis$get_output_path("results.csv", type = "table")
output2 <- analysis$get_output_path("plot.png", type = "figure")

# List all outputs
outputs <- analysis$list_outputs()
length(outputs)  # Number of output files

# List intermediate files
intermediates <- analysis$list_outputs(intermediate = TRUE)
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PMAnalysis-get_output_path"></a>}}
\if{latex}{\out{\hypertarget{method-PMAnalysis-get_output_path}{}}}
\subsection{Method \code{get_output_path()}}{
Get output path for a file, returning a PMData object.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PMAnalysis$get_output_path(name, type = NULL, intermediate = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{name}}{Character. Name of the output file (with or without extension).}

\item{\code{type}}{Character. Optional type of output (table, object, image, figure, parquet, csv).
If provided and name has no extension, an appropriate extension will be added.
If provided and name has an extension, the extension will be validated against the type.}

\item{\code{intermediate}}{Logical. If TRUE, file goes in intermediate/ folder; if FALSE, in outputs/ folder.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A \code{PMData} object with:
\itemize{
\item \code{id}: The file name without extension
\item \code{path}: The full absolute path to the output file
}
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{folder <- withr::local_tempdir()
pm <- pm_create_project(folder)
analysis <- pm$create_analysis("my_analysis")

# Get output path for a CSV file
output <- analysis$get_output_path("results.csv", type = "table")
output$id    # "results"
output$path  # full path to results.csv in outputs/

# Get intermediate path without extension (will add .parquet for table type)
intermediate <- analysis$get_output_path("temp_data", type = "table", intermediate = TRUE)
intermediate$id    # "temp_data"
intermediate$path  # full path to temp_data.parquet in intermediate/
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-PMAnalysis-clone"></a>}}
\if{latex}{\out{\hypertarget{method-PMAnalysis-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{PMAnalysis$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
